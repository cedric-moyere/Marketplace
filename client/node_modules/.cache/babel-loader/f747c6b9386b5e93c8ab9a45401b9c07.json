{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Administrateur\\\\Documents\\\\03-DEV\\\\Cours\\\\Udemy\\\\Marketplace\\\\client\\\\src\\\\components\\\\Checkout\\\\Success.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { saveOrder } from \"../../lib/state/actions\";\nimport useAuthentication from \"../../lib/hooks/useAuthentication\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst styles = {\n  height: \"100vh\",\n  fontSize: 20\n};\n\nfunction Success(_ref) {\n  _s();\n\n  let {\n    history\n  } = _ref;\n  const dispatch = useDispatch();\n  const {\n    user\n  } = useSelector(state => ({ ...state.user\n  }));\n  const {\n    handleAuthentication\n  } = useAuthentication(dispatch);\n\n  function getUserProfile() {\n    return new Promise(resolve => {\n      handleAuthentication();\n      resolve();\n    });\n  }\n\n  function dispatchAndSaveOrder() {\n    return new Promise(async resolve => {\n      const items = localStorage.getItem(\"items\") ? JSON.parse(localStorage.getItem(\"items\")) : [];\n      const total = JSON.parse(localStorage.getItem(\"total\"));\n      const order = {\n        owner_id: user === null || user === void 0 ? void 0 : user._id,\n        email: user === null || user === void 0 ? void 0 : user.email,\n        items: items,\n        total: total\n      };\n      await dispatch(saveOrder(order));\n      resolve();\n    });\n  }\n\n  function clearStorage() {\n    return new Promise(resolve => {\n      localStorage.setItem(\"items\", []);\n      resolve();\n    });\n  }\n\n  function redirectHome() {\n    return new Promise(resolve => {\n      setTimeout(() => history.push(\"/\"), 2000);\n      resolve();\n    });\n  }\n\n  useEffect(() => {\n    async function confirmOrder() {\n      await getUserProfile();\n      await dispatchAndSaveOrder();\n      await clearStorage();\n      await redirectHome();\n    }\n\n    confirmOrder();\n  }, [user]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles,\n      className: \"d-flex justify-content-center align-items-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alert alert-success mt-3 mb-3\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"icontext\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"icon text-success fa fa-thumbs-up\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 13\n          }, this), \"Thank you for your order & your payment\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n\n_s(Success, \"mmj3nOLKAyM0iHRAG23uNm6U5N4=\", false, function () {\n  return [useDispatch, useSelector, useAuthentication];\n});\n\n_c = Success;\nexport default Success;\n\nvar _c;\n\n$RefreshReg$(_c, \"Success\");","map":{"version":3,"sources":["C:/Users/Administrateur/Documents/03-DEV/Cours/Udemy/Marketplace/client/src/components/Checkout/Success.js"],"names":["React","useEffect","useDispatch","useSelector","saveOrder","useAuthentication","styles","height","fontSize","Success","history","dispatch","user","state","handleAuthentication","getUserProfile","Promise","resolve","dispatchAndSaveOrder","items","localStorage","getItem","JSON","parse","total","order","owner_id","_id","email","clearStorage","setItem","redirectHome","setTimeout","push","confirmOrder"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { saveOrder } from \"../../lib/state/actions\";\nimport useAuthentication from \"../../lib/hooks/useAuthentication\";\n\nconst styles = {\n  height: \"100vh\",\n  fontSize: 20,\n};\nfunction Success({ history }) {\n  const dispatch = useDispatch();\n  const { user } = useSelector((state) => ({ ...state.user }));\n  const { handleAuthentication } = useAuthentication(dispatch);\n  function getUserProfile() {\n    return new Promise((resolve) => {\n      handleAuthentication();\n      resolve();\n    });\n  }\n  function dispatchAndSaveOrder() {\n    return new Promise(async (resolve) => {\n      const items = localStorage.getItem(\"items\")\n        ? JSON.parse(localStorage.getItem(\"items\"))\n        : [];\n      const total = JSON.parse(localStorage.getItem(\"total\"));\n      const order = {\n        owner_id: user?._id,\n        email: user?.email,\n        items: items,\n        total: total,\n      };\n      await dispatch(saveOrder(order));\n      resolve();\n    });\n  }\n  function clearStorage() {\n    return new Promise((resolve) => {\n      localStorage.setItem(\"items\", []);\n      resolve();\n    });\n  }\n  function redirectHome() {\n    return new Promise((resolve) => {\n      setTimeout(() => history.push(\"/\"), 2000);\n      resolve();\n    });\n  }\n  useEffect(() => {\n    async function confirmOrder() {\n      await getUserProfile();\n      await dispatchAndSaveOrder();\n      await clearStorage();\n      await redirectHome();\n    }\n    confirmOrder();\n  }, [user]);\n  return (\n    <>\n      <div\n        style={styles}\n        className=\"d-flex justify-content-center align-items-center\"\n      >\n        <div className=\"alert alert-success mt-3 mb-3\">\n          <p className=\"icontext\">\n            <i className=\"icon text-success fa fa-thumbs-up\"></i>Thank you for\n            your order & your payment\n          </p>\n        </div>\n      </div>\n    </>\n  );\n}\nexport default Success;\n"]},"metadata":{},"sourceType":"module"}